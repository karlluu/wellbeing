<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>4-7-8 Breathing Timer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      background-color: #f0f0f0;
      color: #333;
    }
    #phase {
      font-size: 2em;
      margin-bottom: 20px;
    }
    #timer {
      font-size: 3em;
      margin-bottom: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 1.2em;
      cursor: pointer;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
    }
    button:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <div id="phase">Press Start</div>
  <div id="timer">0</div>
  <button id="startStop">Start</button>

  <script>
    const phases = [
      { name: 'Inhale', duration: 4, vibration: [200, 100, 200] }, // Vibrate pattern: 200ms on, 100ms off, 200ms on
      { name: 'Hold', duration: 7, vibration: [200] },
      { name: 'Exhale', duration: 8, vibration: [400] }
    ];
    let currentPhase = 0;
    let timeLeft = 0;
    let isRunning = false;
    let intervalId = null;

    const phaseDisplay = document.getElementById('phase');
    const timerDisplay = document.getElementById('timer');
    const startStopButton = document.getElementById('startStop');

    function updateDisplay() {
      phaseDisplay.textContent = phases[currentPhase].name;
      timerDisplay.textContent = timeLeft;
    }

    function vibrate(pattern) {
      if (navigator.vibrate) {
        navigator.vibrate(pattern);
      } else {
        console.log('Vibration API not supported');
      }
    }

    function startTimer() {
      if (!isRunning) {
        isRunning = true;
        startStopButton.textContent = 'Stop';
        timeLeft = phases[currentPhase].duration;
        updateDisplay();
        vibrate(phases[currentPhase].vibration);

        intervalId = setInterval(() => {
          timeLeft--;
          updateDisplay();
          if (timeLeft <= 0) {
            currentPhase = (currentPhase + 1) % phases.length;
            timeLeft = phases[currentPhase].duration;
            vibrate(phases[currentPhase].vibration);
            updateDisplay();
          }
        }, 1000);
      }
    }

    function stopTimer() {
      if (isRunning) {
        isRunning = false;
        startStopButton.textContent = 'Start';
        clearInterval(intervalId);
        currentPhase = 0;
        timeLeft = phases[currentPhase].duration;
        updateDisplay();
      }
    }

    startStopButton.addEventListener('click', () => {
      if (isRunning) {
        stopTimer();
      } else {
        startTimer();
      }
    });

    // Initialize display
    updateDisplay();
  </script>
</body>
</html>
